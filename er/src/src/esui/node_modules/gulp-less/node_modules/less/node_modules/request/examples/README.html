<h1 id="Authentication">Authentication</h1><h2 id="OAuth">OAuth</h2><h3 id="OAuth1-0_Refresh_Token">OAuth1.0 Refresh Token</h3><ul>
<li><a href="http://oauth.googlecode.com/svn/spec/ext/session/1.0/drafts/1/spec.html#anchor4">http://oauth.googlecode.com/svn/spec/ext/session/1.0/drafts/1/spec.html#anchor4</a></li>
<li><a href="https://developer.yahoo.com/oauth/guide/oauth-refreshaccesstoken.html">https://developer.yahoo.com/oauth/guide/oauth-refreshaccesstoken.html</a></li>
</ul>
<pre><code class="js">request.post(<span class="string">'https://api.login.yahoo.com/oauth/v2/get_token'</span>, {
  oauth: {
    consumer_key: <span class="string">'...'</span>,
    consumer_secret: <span class="string">'...'</span>,
    token: <span class="string">'...'</span>,
    token_secret: <span class="string">'...'</span>,
    session_handle: <span class="string">'...'</span>
  }
}, <span class="function"><span class="keyword">function</span> (<span class="params">err, res, body</span>) </span>{
  <span class="keyword">var</span> result = <span class="built_in">require</span>(<span class="string">'querystring'</span>).parse(body)
  <span class="comment">// assert.equal(typeof result, 'object')</span>
})
</code></pre>
<h3 id="OAuth2_Refresh_Token">OAuth2 Refresh Token</h3><ul>
<li><a href="https://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-6">https://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-6</a></li>
</ul>
<pre><code class="js">request.post(<span class="string">'https://accounts.google.com/o/oauth2/token'</span>, {
  form: {
    grant_type: <span class="string">'refresh_token'</span>,
    client_id: <span class="string">'...'</span>,
    client_secret: <span class="string">'...'</span>,
    refresh_token: <span class="string">'...'</span>
  },
  json: <span class="literal">true</span>
}, <span class="function"><span class="keyword">function</span> (<span class="params">err, res, body</span>) </span>{
  <span class="comment">// assert.equal(typeof body, 'object')</span>
})
</code></pre>
<h1 id="Multipart">Multipart</h1><h2 id="multipart/form-data">multipart/form-data</h2><h3 id="Flickr_Image_Upload">Flickr Image Upload</h3><ul>
<li><a href="https://www.flickr.com/services/api/upload.api.html">https://www.flickr.com/services/api/upload.api.html</a></li>
</ul>
<pre><code class="js">request.post(<span class="string">'https://up.flickr.com/services/upload'</span>, {
  oauth: {
    consumer_key: <span class="string">'...'</span>,
    consumer_secret: <span class="string">'...'</span>,
    token: <span class="string">'...'</span>,
    token_secret: <span class="string">'...'</span>
  },
  <span class="comment">// all meta data should be included here for proper signing</span>
  qs: {
    title: <span class="string">'My cat is awesome'</span>,
    description: <span class="string">'Sent on '</span> + <span class="keyword">new</span> <span class="built_in">Date</span>(),
    is_public: <span class="number">1</span>
  },
  <span class="comment">// again the same meta data + the actual photo</span>
  formData: {
    title: <span class="string">'My cat is awesome'</span>,
    description: <span class="string">'Sent on '</span> + <span class="keyword">new</span> <span class="built_in">Date</span>(),
    is_public: <span class="number">1</span>,
    photo:fs.createReadStream(<span class="string">'cat.png'</span>)
  },
  json: <span class="literal">true</span>
}, <span class="function"><span class="keyword">function</span> (<span class="params">err, res, body</span>) </span>{
  <span class="comment">// assert.equal(typeof body, 'object')</span>
})
</code></pre>
<h1 id="Streams">Streams</h1><h2 id="POST_data"><code>POST</code> data</h2><p>Use Request as a Writable stream to easily <code>POST</code> Readable streams (like files, other HTTP requests, or otherwise).</p>
<p>TL;DR: Pipe a Readable Stream onto Request via:</p>
<pre><code><span class="tag">READABLE</span><span class="class">.pipe</span>(<span class="tag">request</span><span class="class">.post</span>(<span class="tag">URL</span>));
</code></pre><p>A more detailed example:</p>
<pre><code class="js"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)
  , path = <span class="built_in">require</span>(<span class="string">'path'</span>)
  , http = <span class="built_in">require</span>(<span class="string">'http'</span>)
  , request = <span class="built_in">require</span>(<span class="string">'request'</span>)
  , TMP_FILE_PATH = path.join(path.sep, <span class="string">'tmp'</span>, <span class="string">'foo'</span>)
;

<span class="comment">// write a temporary file:</span>
fs.writeFileSync(TMP_FILE_PATH, <span class="string">'foo bar baz quk\n'</span>);

http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>{
  <span class="built_in">console</span>.log(<span class="string">'the server is receiving data!\n'</span>);
  req
    .on(<span class="string">'end'</span>, res.end.bind(res))
    .pipe(process.stdout)
  ;
}).listen(<span class="number">3000</span>).unref();

fs.createReadStream(TMP_FILE_PATH)
  .pipe(request.post(<span class="string">'http://127.0.0.1:3000'</span>))
;
</code></pre>
