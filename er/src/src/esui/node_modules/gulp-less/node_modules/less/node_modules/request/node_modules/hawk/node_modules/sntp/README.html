<h1 id="sntp">sntp</h1><p>An SNTP v4 client (RFC4330) for node. Simpy connects to the NTP or SNTP server requested and returns the server time<br>along with the roundtrip duration and clock offset. To adjust the local time to the NTP time, add the returned <code>t</code> offset<br>to the local time.</p>
<p><a href="http://travis-ci.org/hueniverse/sntp"><img src="https://secure.travis-ci.org/hueniverse/sntp.png" alt="Build Status"></a></p>
<h1 id="Usage">Usage</h1><pre><code class="javascript"><span class="keyword">var</span> Sntp = <span class="built_in">require</span>(<span class="string">'sntp'</span>);

<span class="comment">// All options are optional</span>

<span class="keyword">var</span> options = {
    host: <span class="string">'nist1-sj.ustiming.org'</span>,  <span class="comment">// Defaults to pool.ntp.org</span>
    port: <span class="number">123</span>,                      <span class="comment">// Defaults to 123 (NTP)</span>
    resolveReference: <span class="literal">true</span>,         <span class="comment">// Default to false (not resolving)</span>
    timeout: <span class="number">1000</span>                   <span class="comment">// Defaults to zero (no timeout)</span>
};

<span class="comment">// Request server time</span>

Sntp.time(options, <span class="function"><span class="keyword">function</span> (<span class="params">err, time</span>) </span>{

    <span class="keyword">if</span> (err) {
        <span class="built_in">console</span>.log(<span class="string">'Failed: '</span> + err.message);
        process.exit(<span class="number">1</span>);
    }

    <span class="built_in">console</span>.log(<span class="string">'Local clock is off by: '</span> + time.t + <span class="string">' milliseconds'</span>);
    process.exit(<span class="number">0</span>);
});
</code></pre>
<p>If an application needs to maintain continuous time synchronization, the module provides a stateful method for<br>querying the current offset only when the last one is too old (defaults to daily).</p>
<pre><code class="javascript"><span class="comment">// Request offset once</span>

Sntp.offset(<span class="function"><span class="keyword">function</span> (<span class="params">err, offset</span>) </span>{

    <span class="built_in">console</span>.log(offset);                    <span class="comment">// New (served fresh)</span>

    <span class="comment">// Request offset again</span>

    Sntp.offset(<span class="function"><span class="keyword">function</span> (<span class="params">err, offset</span>) </span>{

        <span class="built_in">console</span>.log(offset);                <span class="comment">// Identical (served from cache)</span>
    });
});
</code></pre>
<p>To set a background offset refresh, start the interval and use the provided now() method. If for any reason the<br>client fails to obtain an up-to-date offset, the current system clock is used.</p>
<pre><code class="javascript"><span class="keyword">var</span> before = Sntp.now();                    <span class="comment">// System time without offset</span>

Sntp.start(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{

    <span class="keyword">var</span> now = Sntp.now();                   <span class="comment">// With offset</span>
    Sntp.stop();
});
</code></pre>
