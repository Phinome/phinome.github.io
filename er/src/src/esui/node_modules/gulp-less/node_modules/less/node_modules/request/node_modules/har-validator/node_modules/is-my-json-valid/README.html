<h1 id="is-my-json-valid">is-my-json-valid</h1><p>A <a href="http://json-schema.org/">JSONSchema</a> validator that uses code generation<br>to be extremely fast</p>
<pre><code>npm install <span class="keyword">is</span>-<span class="keyword">my</span>-json-valid
</code></pre><p>It passes the entire JSONSchema v4 test suite except for <code>remoteRefs</code> and <code>maxLength</code>/<code>minLength</code> when using unicode surrogate pairs.</p>
<p><a href="http://travis-ci.org/mafintosh/is-my-json-valid"><img src="http://img.shields.io/travis/mafintosh/is-my-json-valid.svg?style=flat" alt="build status"></a></p>
<h2 id="Usage">Usage</h2><p>Simply pass a schema to compile it</p>
<pre><code class="js"><span class="keyword">var</span> validator = <span class="built_in">require</span>(<span class="string">'is-my-json-valid'</span>)

<span class="keyword">var</span> validate = validator({
  required: <span class="literal">true</span>,
  type: <span class="string">'object'</span>,
  properties: {
    hello: {
      required: <span class="literal">true</span>,
      type: <span class="string">'string'</span>
    }
  }
})

<span class="built_in">console</span>.log(<span class="string">'should be valid'</span>, validate({hello: <span class="string">'world'</span>}))
<span class="built_in">console</span>.log(<span class="string">'should not be valid'</span>, validate({}))

<span class="comment">// get the last list of errors by checking validate.errors</span>
<span class="comment">// the following will print [{field: 'data.hello', message: 'is required'}]</span>
<span class="built_in">console</span>.log(validate.errors)
</code></pre>
<p>You can also pass the schema as a string</p>
<pre><code class="js"><span class="keyword">var</span> validate = validate(<span class="string">'{"type": ... }'</span>)
</code></pre>
<p>Optionally you can use the require submodule to load a schema from <code>__dirname</code></p>
<pre><code class="js"><span class="keyword">var</span> validator = <span class="built_in">require</span>(<span class="string">'is-my-json-valid/require'</span>)
<span class="keyword">var</span> validate = validator(<span class="string">'my-schema.json'</span>)
</code></pre>
<h2 id="Custom_formats">Custom formats</h2><p>is-my-json-valid supports the formats specified in JSON schema v4 (such as date-time).<br>If you want to add your own custom formats pass them as the formats options to the validator</p>
<pre><code class="js"><span class="keyword">var</span> validate = validator({
  type: <span class="string">'string'</span>,
  required: <span class="literal">true</span>,
  format: <span class="string">'only-a'</span>
}, {
  formats: {
    <span class="string">'only-a'</span>: <span class="regexp">/^a+$/</span>
  }
})

<span class="built_in">console</span>.log(validate(<span class="string">'aa'</span>)) <span class="comment">// true</span>
<span class="built_in">console</span>.log(validate(<span class="string">'ab'</span>)) <span class="comment">// false</span>
</code></pre>
<h2 id="External_schemas">External schemas</h2><p>You can pass in external schemas that you reference using the <code>$ref</code> attribute as the <code>schemas</code> option</p>
<pre><code class="js"><span class="keyword">var</span> ext = {
  required: <span class="literal">true</span>,
  type: <span class="string">'string'</span>
}

<span class="keyword">var</span> schema = {
  $ref: <span class="string">'#ext'</span> <span class="comment">// references another schema called ext</span>
}

<span class="comment">// pass the external schemas as an option</span>
<span class="keyword">var</span> validate = validate(schema, {schemas: {ext: ext}})

validate(<span class="string">'hello'</span>) <span class="comment">// returns true</span>
validate(<span class="number">42</span>) <span class="comment">// return false</span>
</code></pre>
<h2 id="Filtering_away_additional_properties">Filtering away additional properties</h2><p>is-my-json-valid supports filtering away properties not in the schema</p>
<pre><code class="js"><span class="keyword">var</span> filter = validator.filter({
  required: <span class="literal">true</span>,
  type: <span class="string">'object'</span>,
  properties: {
    hello: {type: <span class="string">'string'</span>, required: <span class="literal">true</span>}
  },
  additionalProperties: <span class="literal">false</span>
})

<span class="keyword">var</span> doc = {hello: <span class="string">'world'</span>, notInSchema: <span class="literal">true</span>}
<span class="built_in">console</span>.log(filter(doc)) <span class="comment">// {hello: 'world'}</span>
</code></pre>
<h2 id="Verbose_mode_outputs_the_value_on_errors">Verbose mode outputs the value on errors</h2><p>is-my-json-valid outputs the value causing an error when verbose is set to true</p>
<pre><code class="js"><span class="keyword">var</span> validate = validator({
  required: <span class="literal">true</span>,
  type: <span class="string">'object'</span>,
  properties: {
    hello: {
      required: <span class="literal">true</span>,
      type: <span class="string">'string'</span>
    }
  }
}, {
  verbose: <span class="literal">true</span>
})

validate({hello: <span class="number">100</span>});
<span class="built_in">console</span>.log(validate.errors) <span class="comment">// {field: 'data.hello', message: 'is the wrong type', value: 100}</span>
</code></pre>
<h2 id="Greedy_mode_tries_to_validate_as_much_as_possible">Greedy mode tries to validate as much as possible</h2><p>By default is-my-json-valid bails on first validation error but when greedy is<br>set to true it tries to validate as much as possible:</p>
<pre><code class="js"><span class="keyword">var</span> validate = validator({
  type: <span class="string">'object'</span>,
  properties: {
    x: {
      type: <span class="string">'number'</span>
    }
  },
  required: [<span class="string">'x'</span>, <span class="string">'y'</span>]
}, {
  greedy: <span class="literal">true</span>
});

validate({x: <span class="string">'string'</span>});
<span class="built_in">console</span>.log(validate.errors) <span class="comment">// [{field: 'data.y', message: 'is required'},</span>
                             <span class="comment">//  {field: 'data.x', message: 'is the wrong type'}]</span>
</code></pre>
<h2 id="Performance">Performance</h2><p>is-my-json-valid uses code generation to turn your JSON schema into basic javascript code that is easily optimizeable by v8.</p>
<p>At the time of writing, is-my-json-valid is the <strong>fastest validator</strong> when running</p>
<ul>
<li><a href="https://github.com/Muscula/json-schema-benchmark">json-schema-benchmark</a></li>
<li><a href="http://cosmicrealms.com/blog/2014/08/29/benchmark-of-node-dot-js-json-validation-modules-part-3/">cosmicreals.com benchmark</a></li>
<li><a href="https://github.com/pandastrike/jsck/issues/72#issuecomment-70992684">jsck benchmark</a></li>
<li><a href="https://cdn.rawgit.com/playlyfe/themis/master/benchmark/results.html">themis benchmark</a></li>
<li><a href="https://rawgit.com/zaggino/z-schema/master/benchmark/results.html">z-schema benchmark</a></li>
</ul>
<p>If you know any other relevant benchmarks open a PR and Iâ€™ll add them.</p>
<h2 id="License">License</h2><p>MIT</p>
