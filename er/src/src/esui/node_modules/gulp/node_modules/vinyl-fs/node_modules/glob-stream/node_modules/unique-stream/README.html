<h1 id="unique-stream">unique-stream</h1><p>node.js through stream that emits a unique stream of objects based on criteria</p>
<p><a href="http://travis-ci.org/eugeneware/unique-stream"><img src="https://secure.travis-ci.org/eugeneware/unique-stream.png" alt="build status"></a></p>
<h2 id="Installation">Installation</h2><p>Install via npm:</p>
<pre><code>$ npm <span class="operator"><span class="keyword">install</span> <span class="keyword">unique</span>-stream</span>
</code></pre><h2 id="Examples">Examples</h2><h3 id="Dedupe_a_ReadStream_based_on_JSON-stringify:">Dedupe a ReadStream based on JSON.stringify:</h3><pre><code class="js"><span class="keyword">var</span> unique = <span class="built_in">require</span>(<span class="string">'unique-stream'</span>)
  , Stream = <span class="built_in">require</span>(<span class="string">'stream'</span>);

<span class="comment">// return a stream of 3 identical objects</span>
<span class="function"><span class="keyword">function</span> <span class="title">makeStreamOfObjects</span>(<span class="params"></span>) </span>{
  <span class="keyword">var</span> s = <span class="keyword">new</span> Stream;
  s.readable = <span class="literal">true</span>;
  <span class="keyword">var</span> count = <span class="number">3</span>;
  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) {
    setImmediate(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
      s.emit(<span class="string">'data'</span>, { name: <span class="string">'Bob'</span>, number: <span class="number">123</span> });
      --count &amp;&amp; end();
    });
  }

  <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>) </span>{
    s.emit(<span class="string">'end'</span>);
  }

  <span class="keyword">return</span> s;
}

<span class="comment">// Will only print out one object as the rest are dupes. (Uses JSON.stringify)</span>
makeStreamOfObjects()
  .pipe(unique())
  .on(<span class="string">'data'</span>, <span class="built_in">console</span>.log);
</code></pre>
<h3 id="Dedupe_a_ReadStream_based_on_an_object_property:">Dedupe a ReadStream based on an object property:</h3><pre><code class="js"><span class="comment">// Use name as the key field to dedupe on. Will only print one object</span>
makeStreamOfObjects()
  .pipe(unique(<span class="string">'name'</span>))
  .on(<span class="string">'data'</span>, <span class="built_in">console</span>.log);
</code></pre>
<h3 id="Dedupe_a_ReadStream_based_on_a_custom_function:">Dedupe a ReadStream based on a custom function:</h3><pre><code class="js"><span class="comment">// Use a custom function to dedupe on. Use the 'number' field. Will only print one object.</span>
makeStreamOfObjects()
  .pipe(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>{
    <span class="keyword">return</span> data.number;
  })
  .on(<span class="string">'data'</span>, <span class="built_in">console</span>.log);
</code></pre>
<h2 id="Dedupe_multiple_streams">Dedupe multiple streams</h2><p>The reason I wrote this was to dedupe multiple object streams:</p>
<pre><code class="js"><span class="keyword">var</span> aggregator = unique();

<span class="comment">// Stream 1</span>
makeStreamOfObjects()
  .pipe(aggregator);

<span class="comment">// Stream 2</span>
makeStreamOfObjects()
  .pipe(aggregator);

<span class="comment">// Stream 3</span>
makeStreamOfObjects()
  .pipe(aggregator);

aggregator.on(<span class="string">'data'</span>, <span class="built_in">console</span>.log);
</code></pre>
